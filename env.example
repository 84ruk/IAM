# ========================================
# CONFIGURACI√ìN DE VARIABLES DE ENTORNO
# ========================================
# COPIA ESTE ARCHIVO A .env Y CONFIGURA TUS VALORES REALES
# NUNCA COMMITEES EL ARCHIVO .env REAL

# ========================================
# BASE DE DATOS
# ========================================
# URL de conexi√≥n a PostgreSQL
# Formato: postgresql://usuario:contrase√±a@host:puerto/base_datos
DATABASE_URL="postgresql://usuario:contrase√±a@localhost:5432/iam_db"

# ========================================
# AUTENTICACI√ìN JWT - SEGURIDAD MEJORADA
# ========================================
# Clave secreta para firmar tokens JWT (64 caracteres base64)
# Generada con: openssl rand -base64 64
# IMPORTANTE: Cambia esta clave en producci√≥n y r√≥tala cada 90 d√≠as
JWT_SECRET="ASjgfgRMznJu9kHzbdsoqXXCfh99PTrQEFxO9VgfethW+J6EYmWnFOqgPGI+nzX9qM8Yls1vzCPV66PQB/JFxQ=="

# Tiempo de expiraci√≥n del token JWT (reducido para mayor seguridad)
JWT_EXPIRES_IN="1d"

# Issuer y Audience para JWT (debe coincidir con la configuraci√≥n del backend)
# En desarrollo: http://localhost:3001
# En producci√≥n: https://tu-backend-url.com
JWT_ISSUER="http://localhost:3001"
JWT_AUDIENCE="http://localhost:3001"

# ========================================
# GOOGLE OAUTH - AUTENTICACI√ìN SOCIAL
# ========================================
# Obtener estas credenciales desde: https://console.cloud.google.com/apis/credentials
# 1. Crear proyecto en Google Cloud Console
# 2. Habilitar Google+ API
# 3. Crear credenciales OAuth 2.0
# 4. Configurar URIs autorizados y redirect URIs

# Client ID de Google OAuth
GOOGLE_CLIENT_ID="tu-google-client-id.apps.googleusercontent.com"

# Client Secret de Google OAuth
GOOGLE_CLIENT_SECRET="tu-google-client-secret"

# URL de callback para Google OAuth
# En desarrollo: http://localhost:3001/auth/google/callback
# En producci√≥n: https://tu-backend-url.com/auth/google/callback
GOOGLE_CALLBACK_URL="http://localhost:3001/auth/google/callback"

# ========================================
# COOKIES - CONFIGURACI√ìN DE DOMINIO
# ========================================
# Dominio para las cookies JWT
# En desarrollo: localhost
# En producci√≥n: .tu-dominio.com (con punto para subdominios)
COOKIE_DOMAIN="localhost"

# ========================================
# RATE LIMITING - PROTECCI√ìN CONTRA ATAQUES
# ========================================
# Configuraci√≥n de rate limiting para endpoints cr√≠ticos
RATE_LIMIT_TTL=60000
RATE_LIMIT_LIMIT=10

# Rate limiting espec√≠fico para login
LOGIN_RATE_LIMIT_TTL=60000
LOGIN_RATE_LIMIT_LIMIT=5

# Rate limiting para registro
REGISTER_RATE_LIMIT_TTL=300000
REGISTER_RATE_LIMIT_LIMIT=3

# ========================================
# SERVIDOR
# ========================================
# Puerto donde correr√° el servidor
PORT=3001

# Entorno de ejecuci√≥n
NODE_ENV="development"

# ========================================
# CORS (Cross-Origin Resource Sharing)
# ========================================
# URL del frontend para configurar CORS
# En desarrollo: http://localhost:3000
# En producci√≥n: https://tu-frontend-url.com
FRONTEND_URL="http://localhost:3000"

# ========================================
# LOGGING Y AUDITOR√çA
# ========================================
# Nivel de logging (error, warn, info, debug)
LOG_LEVEL="info"

# Habilitar logging de eventos de autenticaci√≥n
AUTH_AUDIT_ENABLED=true

# ========================================
# SEGURIDAD ADICIONAL
# ========================================
# Tiempo de tolerancia para sincronizaci√≥n de reloj (segundos)
JWT_CLOCK_TOLERANCE=30

# Habilitar validaci√≥n estricta de JWT
JWT_STRICT_VALIDATION=true

# ========================================
# PRODUCCI√ìN (solo para producci√≥n)
# ========================================
# Configuraci√≥n SSL para producci√≥n
SSL_KEY_PATH="/path/to/ssl/key.pem"
SSL_CERT_PATH="/path/to/ssl/cert.pem"

# Configuraci√≥n de base de datos para producci√≥n
PROD_DATABASE_URL="postgresql://prod_user:prod_password@prod_host:5432/prod_db"

# ========================================
# SERVICIOS EXTERNOS (opcional)
# ========================================
# Email service (opcional)
SMTP_HOST="smtp.gmail.com"
SMTP_PORT=587
SMTP_USER="tu_email@gmail.com"
SMTP_PASS="tu_contrase√±a_de_aplicacion"

# Redis (opcional, para cache y blacklist de tokens)
REDIS_URL="redis://localhost:6379"

# ========================================
# MONITORING (opcional)
# ========================================
# Sentry para monitoreo de errores
SENTRY_DSN="https://tu-dsn-de-sentry@sentry.io/project"

# ========================================
# NOTAS DE SEGURIDAD JWT
# ========================================
# ‚úÖ CLAIMS EST√ÅNDAR IMPLEMENTADOS:
# - iss (issuer): http://localhost:3001 (desarrollo) / https://tu-backend-url.com (producci√≥n)
# - aud (audience): http://localhost:3001 (desarrollo) / https://tu-backend-url.com (producci√≥n)  
# - iat (issued at): timestamp de emisi√≥n
# - exp (expiration): timestamp de expiraci√≥n
# - jti (JWT ID): identificador √∫nico del token
# - sub (subject): ID del usuario
#
# ‚úÖ RATE LIMITING IMPLEMENTADO:
# - Login: 5 intentos por minuto
# - Registro: 3 intentos por 5 minutos
# - General: 10 requests por minuto
#
# ‚úÖ VALIDACIONES DE SEGURIDAD:
# - Validaci√≥n de claims requeridos
# - Validaci√≥n de issuer y audience
# - Validaci√≥n de expiraci√≥n autom√°tica
# - Clave secreta de 64 caracteres base64
#
# ‚úÖ GOOGLE OAUTH IMPLEMENTADO:
# - Autenticaci√≥n social con Google
# - Creaci√≥n autom√°tica de usuarios
# - Integraci√≥n con JWT existente
#
# üîÑ PR√ìXIMAS MEJORAS:
# - Refresh tokens
# - Blacklist de tokens revocados
# - Rotaci√≥n autom√°tica de claves
# - Auditor√≠a completa de eventos 