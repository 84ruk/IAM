# LibrerÃ­as necesarias para ESP32 IAM
# Instalar desde Arduino IDE: Herramientas > Administrar Bibliotecas

## LibrerÃ­as Principales (ESP32)
- **ESP32 by Espressif Systems** (incluida en Arduino IDE)
- **WiFi** (incluida)
- **WebServer** (incluida)
- **SPI** (incluida)
- **Wire** (incluida)

## LibrerÃ­as de Sensores
- **DHT sensor library by Adafruit** (para DHT22)
  - Buscar: "DHT sensor library"
  - Autor: Adafruit
  - VersiÃ³n: 1.4.4 o superior

- **HX711 by Bogdan Necula** (para sensor de peso)
  - Buscar: "HX711"
  - Autor: Bogdan Necula
  - VersiÃ³n: 0.7.4 o superior

- **Adafruit BMP280 Library by Adafruit** (para sensor de presiÃ³n)
  - Buscar: "Adafruit BMP280 Library"
  - Autor: Adafruit
  - VersiÃ³n: 2.6.6 o superior

- **Adafruit Unified Sensor by Adafruit** (requerida por BMP280)
  - Buscar: "Adafruit Unified Sensor"
  - Autor: Adafruit
  - VersiÃ³n: 1.1.9 o superior

## LibrerÃ­as de ComunicaciÃ³n
- **PubSubClient by Nick O'Leary** (para MQTT)
  - Buscar: "PubSubClient"
  - Autor: Nick O'Leary
  - VersiÃ³n: 2.8 o superior

- **ArduinoJson by Benoit Blanchon** (para JSON)
  - Buscar: "ArduinoJson"
  - Autor: Benoit Blanchon
  - VersiÃ³n: 6.21.3 o superior

## ConfiguraciÃ³n de Arduino IDE

### 1. Configurar Board
- Board: "ESP32 Dev Module"
- Upload Speed: "115200"
- CPU Frequency: "240MHz (WiFi/BT)"
- Flash Frequency: "80MHz"
- Flash Mode: "QIO"
- Flash Size: "4MB (32Mb)"
- Partition Scheme: "Default 4MB with spiffs (1.2MB APP/1.5MB SPIFFS)"
- Core Debug Level: "None"
- PSRAM: "Disabled"

### 2. Configurar PubSubClient
DespuÃ©s de instalar PubSubClient, editar el archivo:
`~/Arduino/libraries/PubSubClient/src/PubSubClient.h`

Cambiar:
```cpp
#define MQTT_MAX_PACKET_SIZE 128
```

Por:
```cpp
#define MQTT_MAX_PACKET_SIZE 512
```

### 3. Conexiones de Sensores

#### DHT22 (Temperatura y Humedad)
- VCC â†’ 3.3V
- GND â†’ GND
- DATA â†’ GPIO 4

#### HX711 (Peso)
- VCC â†’ 3.3V
- GND â†’ GND
- DOUT â†’ GPIO 16
- SCK â†’ GPIO 17

#### BMP280 (PresiÃ³n)
- VCC â†’ 3.3V
- GND â†’ GND
- SDA â†’ GPIO 21
- SCL â†’ GPIO 22

## Pasos de InstalaciÃ³n

1. **Abrir Arduino IDE**
2. **Instalar ESP32 Board Manager**:
   - Archivo > Preferencias
   - Agregar URL: `https://raw.githubusercontent.com/espressif/arduino-esp32/gh-pages/package_esp32_index.json`
   - Herramientas > Placa > Administrador de tarjetas
   - Buscar "ESP32" e instalar

3. **Instalar LibrerÃ­as**:
   - Herramientas > Administrar Bibliotecas
   - Buscar e instalar cada librerÃ­a de la lista

4. **Configurar Board**:
   - Herramientas > Placa > ESP32 Arduino > ESP32 Dev Module
   - Configurar parÃ¡metros como se indica arriba

5. **Editar PubSubClient**:
   - Aumentar MQTT_MAX_PACKET_SIZE a 512

6. **Subir CÃ³digo**:
   - Abrir archivo `esp32-complete-code.ino`
   - Verificar y subir

## VerificaciÃ³n

DespuÃ©s de subir el cÃ³digo, abrir Monitor Serial (115200 baud) y deberÃ­as ver:

```
ğŸš€ Iniciando IAM ESP32...
==================================
ğŸ†” Device ID: esp32_1234567890_1234
ğŸ“ Device Name: ESP32 IAM 456
ğŸ”§ Configurando sensores...
âœ… DHT22 inicializado
âœ… HX711 inicializado
âœ… BMP280 inicializado
ğŸ“‹ Cargando configuraciÃ³n...
ğŸ“¡ Configurando WiFi...
âœ… AP configurado
ğŸ“¶ SSID: IAM_ESP32_Config
ğŸ”‘ Password: iam-setup-2024
ğŸŒ IP AP: 192.168.4.1
ğŸŒ Configurando servidor web...
âœ… Servidor web iniciado
âœ… Setup completado
==================================
ğŸŒ Portal de configuraciÃ³n disponible en:
   http://192.168.4.1
ğŸ“± Conecta tu dispositivo a la red 'IAM_ESP32_Config'
ğŸ”‘ ContraseÃ±a: iam-setup-2024
```

## ConfiguraciÃ³n Inicial

1. **Conectar al WiFi del ESP32**:
   - SSID: `IAM_ESP32_Config`
   - Password: `iam-setup-2024`

2. **Abrir navegador**:
   - URL: `http://192.168.4.1`

3. **Configurar WiFi y MQTT**:
   - Ingresar credenciales de tu red WiFi
   - Configurar servidor MQTT (desde tu backend IAM)

4. **Verificar funcionamiento**:
   - Los datos de sensores deberÃ­an aparecer en el portal
   - Los datos se enviarÃ¡n por MQTT al backend


